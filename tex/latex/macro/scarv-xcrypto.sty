% Copyright (C) 2019 SCARV project <info@scarv.org>
%
% Use of this source code is restricted per the MIT license, a copy of which 
% can be found at https://opensource.org/licenses/MIT (or should be included 
% as LICENSE.txt within the associated archive or repository).

% =============================================================================

\newcommandx{\XCRYPTO}[1][1={}]{\mbox{{\sf XCrypto}\IfEq{#1}{}{}{[#1]}}\xspace}

\newcommand{\XCRYPTOSYNTAXDEF}[2]{%
  \expandafter\newcommand\csname rmk-#1\endcsname{\VERB[RV]{#1 #2}}%
}

\newcommand{\XCRYPTOSYNTAXUSE}[1]{\csname rmk-#1\endcsname}

\newcommandx{\XCRYPTOINSTR}[5]{
  \paragraph{\VERB[RV]{#1}}
  \label{sec:spec:instruction:#1} \XCRYPTOSYNTAXDEF{#1}{#2}

  \begin{itemize}[labelindent=0pt,align=left,noitemsep,leftmargin=*]
  \item {\bf Compatibility:}
        #3
  \item {\bf Description:} 
        #4
  \item {\bf Encoding:}

        \begin{center}
        \begin{bytefield}[bitwidth={1.1em},endianness={big}]{32}
        \bitheader{0-31} \\ \XCRYPTOENCODE{#1}
        \end{bytefield}
        \end{center}

  \item {\bf Syntax and semantics:}
        \[
        \XCRYPTOSYNTAXUSE{#1}
        ~~~\mapsto~~~
        \left\{
        \begin{array}{c}
        \begin{algorithm}[H]
        \Begin {
          #5
        }
        \end{algorithm}
        \end{array}
        \right.
        \]
  \end{itemize}
}

% =============================================================================
