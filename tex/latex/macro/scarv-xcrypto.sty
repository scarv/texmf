% Copyright (C) 2019 SCARV project <info@scarv.org>
%
% Use of this source code is restricted per the MIT license, a copy of which 
% can be found at https://opensource.org/licenses/MIT (or should be included 
% as LICENSE.txt within the associated archive or repository).

% =============================================================================

\newcommandx{\XCID}[1][1={}]{\mbox{{\sf XCrypto}\IfEq{#1}{}{}{[#1]}}\xspace}
\newcommandx{\SCID}[1][1={}]{\mbox{{\sf SCrypto}\IfEq{#1}{}{}{[#1]}}\xspace}
\newcommandx{\XCLEN}{{\rm XCLEN}\xspace}

\newcommand{\XCSYNTAXDEF}[2]{%
  \expandafter\newcommand\csname rmk-#1\endcsname{\VERB[RV]{#1 #2}}%
}

\newcommand{\XCSYNTAXUSE}[1]{\csname rmk-#1\endcsname}

\newcommandx{\XCINSTR}[4]{
  \paragraph{\VERB[RV]{#1}}
  \label{sec:spec:instruction:#1} \XCSYNTAXDEF{#1}{#2}

  \begin{itemize}[labelindent=0pt,align=left,noitemsep]
  \item {\bf Description:} 
        #3
  \item {\bf Encoding:}

        \begin{center}
        \begin{bytefield}[bitwidth={1.2em},endianness={big}]{32}
        \bitheader{0-31} \\ \XCENCODE{#1}
        \end{bytefield}
        \end{center}

  \item {\bf Syntax and semantics:}
        \[
        \XCSYNTAXUSE{#1}
        ~~~\mapsto~~~
        \left\{
        \begin{array}{c}
        \begin{algorithm}[H]
        \Begin {
          #4
        }
        \end{algorithm}
        \end{array}
        \right.
        \]
  \end{itemize}
}

\newcommandx{\XCR}[2][1={},2={}]{{\ensuremath\IfEq{#1}{*}{{\sf XCR}[{#2}]}{{\sf XCR}}}\xspace}

% =============================================================================
